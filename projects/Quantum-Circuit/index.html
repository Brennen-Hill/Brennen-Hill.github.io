<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Quantum Circuit | Brennen A. Hill </title> <meta name="author" content="Brennen A. Hill"> <meta name="description" content="Production-Ready Pattern Matching for Quantum Circuit Optimization."> <meta name="keywords" content="Brennen Hill, Brennen A. Hill, Brennen Alexander Hill, Researcher, Neuroscience, AI, NeuroAI, Machine Learning, Reinforcement Learning, World Models, Neuromorphic Computing, Engineer"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/Favicon.png?bfe1cbd95a5c0b203535788fc4fe0d0e"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://brennen-hill.github.io/projects/Quantum-Circuit/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Brennen</span> A. Hill </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Quantum Circuit</h1> <p class="post-description">Production-Ready Pattern Matching for Quantum Circuit Optimization.</p> <div class="small text-muted mb-3"> <p class="d-flex align-items-center mb-1"><i class="fas fa-user-tie fa-fw me-2"></i>Lead Research Engineer</p> <p class="d-flex align-items-center mb-1"><i class="fas fa-building fa-fw me-2"></i>Hughes Research Laboratories (HRL)</p> <p class="d-flex align-items-center mb-1"> <i class="fas fa-calendar-alt fa-fw me-2"></i>June 2023 - August 2023</p> </div> </header> <article> <div class="col"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/PatternAndCircuit-480.webp 480w,/assets/img/PatternAndCircuit-800.webp 800w,/assets/img/PatternAndCircuit-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/PatternAndCircuit.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h3 id="abstract">Abstract</h3> <p>Fidelity in Noisy Intermediate-Scale Quantum (NISQ) computers is fundamentally limited by gate errors and qubit decoherence, making circuit optimization a critical task. This project details the engineering of a production-ready optimization pass within the <strong>Quilc quantum compiler</strong> to reduce circuit depth. The system implements an exact pattern-matching algorithm, translating a novel theoretical framework into a high-impact optimization tool. A <strong>two-phase algorithmic solution</strong> was devised to manage the combinatorial complexity: (1) a greedy forward-pass on the circuit’s DAG representation to find a valid seed match, followed by (2) a comprehensive backtracking search to maximally expand the match. This optimization pass demonstrated significant, measurable impact, <strong>reducing quantum circuit depth by up to 37%</strong>, thereby shortening execution time and enhancing algorithmic fidelity by mitigating decoherence.</p> <hr> <h2 id="1-introduction--problem-statement">1. Introduction &amp; Problem Statement</h2> <p>The primary limitation of the current NISQ era of quantum computing is the accumulation of noise, which stems from gate infidelities and qubit decoherence over time. The probability of a successful computation decreases exponentially with the number of gates and the depth of the circuit. Therefore, a central goal of quantum compiler design is to minimize these two metrics.</p> <p>A powerful technique for this is <em>peephole optimization</em>, which involves identifying and replacing small sub-circuits (patterns) with more efficient, functionally equivalent ones. This project focuses on a specific, high-impact case: finding and removing circuit patterns that are topologically equivalent to the <strong>identity function</strong> (i.e., patterns that perform no net operation). The challenge lies in formally and efficiently identifying these patterns, as the equivalence can be obscured by gate commutations and the reordering of operations on different qubits.</p> <h2 id="2-theoretical-foundation">2. Theoretical Foundation</h2> <p>This work translates the theoretical method proposed by Iten et al. in <strong>“Exact and practical pattern matching for quantum circuit optimization” [arXiv:1909.05270]</strong> into a practical, production-level compiler tool.</p> <p>The core of the Iten et al. algorithm is a formal, graph-based method for finding all <em>maximal</em> matches of a given pattern within a larger quantum circuit. A key feature of their approach is that it correctly handles the physics of quantum circuits, specifically by accounting for the <strong>pairwise commutation rules</strong> of quantum gates. This project involved adapting this formal algorithm and engineering it for integration into the Common Lisp codebase of the <code class="language-plaintext highlighter-rouge">quilc</code> compiler.</p> <h2 id="3-algorithmic-solution--implementation">3. Algorithmic Solution &amp; Implementation</h2> <p>To navigate the high combinatorial complexity of the matching problem, a two-phase algorithmic solution was designed and implemented.</p> <h3 id="31-phase-1-greedy-forward-pass-seed-matching">3.1. Phase 1: Greedy Forward-Pass Seed Matching</h3> <div class="col"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/CanonicalForm-480.webp 480w,/assets/img/CanonicalForm-800.webp 800w,/assets/img/CanonicalForm-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/CanonicalForm.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The algorithm first operates on the circuit’s <strong>Directed Acyclic Graph (DAG)</strong> representation.</p> <div class="col"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ForwardMatchResult-480.webp 480w,/assets/img/ForwardMatchResult-800.webp 800w,/assets/img/ForwardMatchResult-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/ForwardMatchResult.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>It executes a greedy forward-pass to rapidly identify a valid <em>seed match</em>. This phase efficiently finds an initial, valid (but not necessarily maximal) subgraph isomorphism, which serves as a starting point for a more exhaustive search.</p> <h3 id="32-phase-2-maximal-expansion-via-backtracking-search">3.2. Phase 2: Maximal Expansion via Backtracking Search</h3> <div class="col"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/BackwardMatchResult-480.webp 480w,/assets/img/BackwardMatchResult-800.webp 800w,/assets/img/BackwardMatchResult-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/BackwardMatchResult.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The seed match from Phase 1 is then fed into a comprehensive <strong>backtracking search</strong> algorithm designed to maximally expand the match. This phase solves the core combinatorial challenge of the project, which involves:</p> <ul> <li> <strong>Deciding whether to incorporate preceding gates</strong> into the match, which may require invalidating parts of the initial forward seed.</li> <li> <strong>Commuting non-matching “disturbing gates”</strong> (i.e., gates that temporarily block a match but commute with the pattern’s gates) out of the active matching window.</li> </ul> <div class="col"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/MaximalMatch-480.webp 480w,/assets/img/MaximalMatch-800.webp 800w,/assets/img/MaximalMatch-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/MaximalMatch.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>This backtracking process guarantees that the final match found is maximal, ensuring the largest possible identity-pattern is identified for removal.</p> <h2 id="4-system-architecture--compiler-integration">4. System Architecture &amp; Compiler Integration</h2> <p>The algorithm was engineered as a robust optimization pass within the <code class="language-plaintext highlighter-rouge">quilc</code> compiler, exposing two primary functions as its interface:</p> <ol> <li> <strong><code class="language-plaintext highlighter-rouge">pattern-match</code></strong>: Takes a circuit and a single identity-realizing pattern as input. It searches the circuit and returns a list of all found <code class="language-plaintext highlighter-rouge">match</code> objects.</li> <li> <strong><code class="language-plaintext highlighter-rouge">pattern-replace</code></strong>: Takes a circuit and a list of patterns. It iteratively calls <code class="language-plaintext highlighter-rouge">pattern-match</code> for each pattern, replacing the matched sub-circuits. This process repeats until a fixed point is reached and no further optimizations can be found.</li> </ol> <p>The system was built for extensibility. It relies on an abstract <code class="language-plaintext highlighter-rouge">gate</code> superclass, requiring a specific interface to be implemented. This design allows the pattern-matching engine to operate on any set of quantum gates, making it a general-purpose tool within the compiler.</p> <h2 id="5-results--quantifiable-impact">5. Results &amp; Quantifiable Impact</h2> <p>The impact of the optimization pass was rigorously quantified. Benchmarks demonstrated that the implementation can achieve <strong>reductions in quantum circuit depth by up to 37%</strong>.</p> <p>This result is highly significant for practical quantum computation.</p> <ul> <li> <strong>Shortened Execution Time</strong>: A more shallow circuit executes faster on quantum hardware.</li> <li> <strong>Enhanced Algorithmic Fidelity</strong>: This is the most critical outcome. By substantially reducing the number of gates and the overall depth, the algorithm directly mitigates the cumulative effects of qubit decoherence and gate errors, leading to a higher probability of a correct and meaningful result.</li> </ul> <h2 id="6-conclusion">6. Conclusion</h2> <p>This project successfully demonstrates the translation of a novel, theoretically complex pattern-matching algorithm into a production-ready, high-impact optimization tool for a quantum compiler. The developed two-phase (greedy-seed + backtracking-expansion) solution proved effective in managing the inherent combinatorial search problem, delivering significant, measurable improvements in circuit fidelity crucial for advancing NISQ-era quantum applications.</p> <p>This system implements the quantum circuit pattern matching algorithm of Iten et al. It was created during an internship at HRL Laboratories.</p> <p><strong>Official Source:</strong> <a href="https://github.com/quil-lang/quilc/tree/master/src/match" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">https://github.com/quil-lang/quilc/tree/master/src/match</code></a></p> <h2 id="description">Description</h2> <p>The system exposes two primary functions as the interface: <code class="language-plaintext highlighter-rouge">pattern-match</code> and <code class="language-plaintext highlighter-rouge">pattern-replace</code>.</p> <p><code class="language-plaintext highlighter-rouge">pattern-match</code> takes a circuit and a pattern that realises the identity function as input. The circuit is then searched for matches of the pattern. The list of these matches is returned.</p> <p><code class="language-plaintext highlighter-rouge">pattern-replace</code> takes a circuit and a list of patterns as input. <code class="language-plaintext highlighter-rouge">pattern-match</code> is called with each pattern. Each match with the pattern in the circuit is then replaced with the unmatched section of the pattern. Then <code class="language-plaintext highlighter-rouge">pattern-replace</code> repeats. The return value of <code class="language-plaintext highlighter-rouge">pattern-replace</code> is the optimized circuit.</p> <p>It can be useful to print out the current state of <code class="language-plaintext highlighter-rouge">pattern-match</code> and <code class="language-plaintext highlighter-rouge">pattern-replace</code>. To do so, three methods are provided:</p> <ul> <li> <code class="language-plaintext highlighter-rouge">(print-circ circuit)</code> takes a circuit as input and prints a visual representation of the circuit</li> <li> <code class="language-plaintext highlighter-rouge">(print-circ-as-canon circuit)</code> takes a circuit as input and prints a visual representation of the canonical form of the circuit</li> <li> <code class="language-plaintext highlighter-rouge">(print-canon-data canonical-form)</code> takes a <code class="language-plaintext highlighter-rouge">canonical-form</code> as input and prints a visual representation of the canonical form</li> </ul> <h2 id="how-to-use">How To Use</h2> <ol> <li>Load <code class="language-plaintext highlighter-rouge">"cl-quil/match"</code>.</li> <li>Implement the gate interface by creating a subclass of the class <code class="language-plaintext highlighter-rouge">gate</code>. An example of how to do this can be found in <code class="language-plaintext highlighter-rouge">test-gate.lisp</code> </li> <li>Realise a circuit and a pattern as lists of objects that subclass <code class="language-plaintext highlighter-rouge">gate</code>.</li> <li>Run <code class="language-plaintext highlighter-rouge">(pattern-match circuit pattern)</code> or <code class="language-plaintext highlighter-rouge">(pattern-replace circuit patterns)</code>.</li> </ol> <h2 id="how-to-test">How To Test</h2> <p>Run the following command:</p> <div class="language-lisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nv">asdf:test-system</span> <span class="s">"cl-quil/match"</span><span class="p">)</span>
</code></pre></div></div> </article> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 Brennen A. Hill. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script src="/assets/js/tooltips-setup.js?53023e960fbc64cccb90d32e9363de2b"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>