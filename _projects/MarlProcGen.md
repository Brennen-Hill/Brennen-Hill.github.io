---
layout: page
title: MARL ProcGen
description: Training defenders and an adversarial level generator simultaneously.
img: assets/img/MarlProg.jpeg
importance: 1
category: research
related_publications: false
---

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/MarlProg.jpeg" title="ExoSky" class="img-fluid rounded z-depth-1" %}
    </div>
</div>
<div class="caption">
    The board and pieces that make up the multi-agent environment.
</div>

We designed a system in which multiple sequential learning agents (defenders) are combating an adversarial agent who uses procedural generation (attacker). The goal was to train the attacker to procedurally generate levels that would defeat the defenders while also training the defenders to defeat the levels generated by the attacker.

We built a board with ten lanes, each 30 tiles long.

Four defenders were located on the first through fourth tiles. Each tick, each defender can move left, move right, shoot, heal, use a special ability, or do nothing. Each defender has an amount of energy they can spend on actions, which replenishes over time up to a maximum.

An attacker is located at the opposite end of the board, 26 tiles from the closest of the four defenders. Each tick, the attacker can either generate a spawn in a chosen location or do nothing. If the attacker generates a spawn, it decides on how much life, damage, speed, range, regen, leach, physical penetration, magic penetration, physical defense, and magic defense to give it and decides its damage type. The attacker can spend energy on generating spawns, which recovers over time. The attacker also has a maximum amount of energy, which very slowly increases over time. The stronger the spawn, the more energy it will cost.

The spawns follow a very simple set of rules. If a defender is within their range, they shoot. Otherwise they move forwards.

If a spawn reaches the edge of the board, past the defenders, or if a defender is defeated, then the attacker wins. The defenders’ goal is to last as long as they can before a spawn passes them and to avoid any defender losing all life.

<div class="caption">
    A video link demonstrating the learned behaviors from early in the training process.
</div>

## Contributed to initial environment

Brennen Hill, Takatoshi Soeda, Rishu Khare, Sambhav Satija, Garrett Oamek
